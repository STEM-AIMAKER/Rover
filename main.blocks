<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="R_+FekAp`hw6hD%$RRwZ" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="io7UXMV{jU3LamkYc(Or" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace hscobot {" line1="    let serialInited = 0;" line2="    let serialReadLine = &quot;&quot;;" line3="    " line4="    export enum CarMode {" line5="        //% blockId=&quot;Manual&quot; block=&quot;Manual&quot;" line6="        Manual = 0," line7="        //% blockId=&quot;AIDrive&quot; block=&quot;AI&quot;" line8="        AIDrive = 1," line9="        //% blockId=&quot;BallTracking&quot; block=&quot;Ball Tracking&quot;" line10="        BallTracking=2," line11="        //% blockId=&quot;PersonDetect&quot; block=&quot;Person Detect&quot;" line12="        PersonDetect=3," line13="        //% blockId=&quot;FaceDetect&quot; block=&quot;Face Detect&quot;" line14="        FaceDetect=4" line15="    }" line16="" line17="    export enum ColorFilter {" line18="        //% blockId=&quot;Red&quot; block=&quot;Red&quot;" line19="        Red = 0," line20="        //% blockId=&quot;Green&quot; block=&quot;Green&quot;" line21="        Green = 1," line22="        //% blockId=&quot;Blue&quot; block=&quot;Blue&quot;" line23="        Blue = 2," line24="        //% blockId=&quot;Black&quot; block=&quot;Black&quot;" line25="        Black = 3" line26="    }" line27="" line28="    export enum Directions {" line29="        //% blockId=&quot;Positive&quot; block=&quot;Positive&quot;" line30="        Positive = 0," line31="        //% blockId=&quot;Negative&quot; block=&quot;Negative&quot;" line32="        Negative = 1" line33="    }" line34="" line35="    function initSerial(): void {" line36="        if (0 == serialInited) {" line37="            serial.setRxBufferSize(64)" line38="            serial.redirect(" line39="                SerialPin.P16," line40="                SerialPin.P8," line41="                BaudRate.BaudRate115200" line42="            );" line43="            serialInited = 1;" line44="        }" line45="    }" line46="" line47="    function addParameter(i: number): string {" line48="        let str = &quot;&quot;;" line49="        if (i &lt; 10) {" line50="            str = &quot;00&quot; + i;" line51="        } else if (i &lt; 100) {" line52="            str = &quot;0&quot; + i;" line53="        } else {" line54="            str = (i).toString();" line55="        }" line56="        return str;" line57="    }" line58="" line59="   " line60="    //% blockId=runMotor block=&quot;Manual mode run motor at left speed=%LeftSpeed direction=%LeftDirection right speed=%RightSpeed direction=%RightDirection&quot;" line61="    //% LeftSpeed.min=0 LeftSpeed.max=360" line62="    //% LeftDirection.fieldEditor=&quot;gridpicker&quot; LeftDirection.fieldOptions.columns=1" line63="    //% RightSpeed.min=0 RightSpeed.max=360" line64="    //% RightDirection.fieldEditor=&quot;gridpicker&quot; RightDirection.fieldOptions.columns=1" line65="    export function runMotor( LeftSpeed: number, LeftDirection: Directions, RightSpeed : number, RightDirection : Directions): void {" line66="           //CM +方向A(1Byte)+方向B(1Byte)+占空比A(3BYTE)+占空比B(3Byte)" line67="        initSerial();" line68="        let cmd = &quot;&quot;;" line69="        let LD = &quot;1&quot;" line70="        let RD = &quot;1&quot;" line71="        if (LeftDirection == Directions.Negative)" line72="            LD = &quot;0&quot;" line73="        if (RightDirection == Directions.Negative)" line74="            RD = &quot;0&quot;" line75="" line76="        cmd = &quot;CM&quot; + LD + RD + addParameter(LeftSpeed) + addParameter(RightSpeed);" line77="        serial.writeLine(cmd);" line78="    }" line79="" line80="    //% blockId=stopCar block=&quot;Stop car in manual mode&quot;" line81="    export function stopCar(): void {" line82="        runMotor(0, Directions.Positive, 0, Directions.Positive);" line83="    }" line84="" line85="    //% blockId=pauseAI block=&quot;Pause AI Model&quot;" line86="    export function pauseAI(): void {" line87="        initSerial();" line88="        let cmd2 = &quot;EXPS+++++0&quot;; // Pause" line89="        serial.writeLine(cmd2);" line90="    }" line91="" line92="    //% blockId=resumeAI block=&quot;Resume AI Model&quot;" line93="    export function resumeAI(): void {" line94="        initSerial();" line95="        let cmd3 = &quot;EXPS+++++1&quot;; " line96="        serial.writeLine(cmd3);" line97="    }" line98="" line99="    //% blockId=rebootAIModule block=&quot;Reboot AI module&quot;" line100="    export function rebootAIModule():void {" line101="        let cmd4 = &quot;EXRS++++++&quot;" line102="        initSerial();" line103="        serial.writeLine(cmd4);" line104="        basic.pause(3000)" line105="    }" line106="" line107="    //% weight=90" line108="    //% blockId=switchAIMode block=&quot;Switch car mode to |%mode&quot;" line109="    //% mode.fieldEditor=&quot;gridpicker&quot; mode.fieldOptions.columns=2" line110="    export function switchAIMode(mode: CarMode): void {" line111="        let cmd5 = &quot;&quot;;" line112="        initSerial();" line113="        switch (mode) {" line114="            case CarMode.Manual:" line115="                cmd5 = &quot;EXPS+++++0&quot;; // Pause" line116="                break;" line117="            case CarMode.AIDrive:" line118="                cmd5 = &quot;EXMO+++++0&quot;" line119="                break;" line120="            case CarMode.BallTracking:" line121="                cmd5 = &quot;EXMO+++++1&quot;" line122="                break;" line123="            case CarMode.PersonDetect:" line124="                cmd5 = &quot;EXMO+++++2&quot;" line125="                break;" line126="            case CarMode.FaceDetect:" line127="                cmd5 = &quot;EXMO+++++3&quot;" line128="                break;" line129="        }" line130="" line131="        if (cmd5.length &gt; 0) {" line132="            serial.writeLine(cmd5);" line133="            basic.pause(100);" line134="        }" line135="    }" line136="  " line137="    //% weight=90" line138="    //% blockId=changeAIColor block=&quot;Change AI color to |%color&quot;" line139="    //% color.fieldEditor=&quot;gridpicker&quot; color.fieldOptions.columns=2" line140="    export function changeAIColor(color: ColorFilter): void {" line141="        let cmd6 = &quot;EXCO+++++&quot; + (color).toString();" line142="        initSerial();       " line143="        serial.writeLine(cmd6);" line144="        basic.pause(100);" line145="    }" line146="" line147="    serial.onDataReceived(serial.delimiters(Delimiters.NewLine), function () {" line148="        serialReadLine = serial.readLine();" line149="    })" line150="}" numlines="151"></mutation><comment id="undefined" pinned="false" h="80" w="160">% weight=10 color=#1E90FF icon="\uf136"</comment></block></statement></block></xml>